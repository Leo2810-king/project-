<!doctype html>
<html lang="vi">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>üîê WEB M√£ H√≥a AES-GCM - B·∫£o M·∫≠t Th√¥ng Tin</title>
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <main class="card">
        <h1>üîê M√£ H√≥a (AES-GCM)</h1>
        <p class="subtitle">·ª®ng d·ª•ng m√£ h√≥a vƒÉn b·∫£n v√† file s·ª≠ d·ª•ng thu·∫≠t to√°n AES-256-GCM</p>

        <!-- Thanh tab ƒëi·ªÅu h∆∞·ªõng -->
        <div class="tab-container">
            <div class="tabs">
                <button class="tab-btn active" data-tab="encrypt">üìù M√£ H√≥a VƒÉn B·∫£n</button>
                <button class="tab-btn" data-tab="decrypt">üîì Gi·∫£i M√£ VƒÉn B·∫£n</button>
                <button class="tab-btn" data-tab="file">üìÅ M√£ H√≥a File</button>
                <button class="tab-btn" data-tab="info">‚ÑπÔ∏è Th√¥ng Tin</button>
            </div>

            <!-- Tab 1: M√£ h√≥a vƒÉn b·∫£n -->
            <div id="encrypt-tab" class="tab-content active">
                <div class="section">
                    <label for="inputText">üìù VƒÉn b·∫£n c·∫ßn m√£ h√≥a:</label>
                    <textarea id="inputText" placeholder="Nh·∫≠p n·ªôi dung c·∫ßn m√£ h√≥a t·∫°i ƒë√¢y..." rows="6"></textarea>
                    <div class="text-info">
                        <span>ƒê·ªô d√†i: <span id="inputLength">0</span> k√Ω t·ª±</span>
                    </div>
                </div>

                <div class="row">
                    <div class="col">
                        <label for="password">üîë M·∫≠t kh·∫©u b·∫£o m·∫≠t:</label>
                        <div class="password-container">
                            <input id="password" type="password" placeholder="Nh·∫≠p m·∫≠t kh·∫©u m·∫°nh (t·ªëi thi·ªÉu 8 k√Ω t·ª±)" />
                            <button type="button" class="password-toggle" id="togglePassword">üëÅÔ∏è</button>
                        </div>
                        <!-- Thanh ƒë√°nh gi√° ƒë·ªô m·∫°nh m·∫≠t kh·∫©u -->
                        <div class="password-strength">
                            <div class="strength-bar">
                                <div class="strength-fill" id="strengthFill"></div>
                            </div>
                            <span id="strengthText">Nh·∫≠p m·∫≠t kh·∫©u ƒë·ªÉ ki·ªÉm tra ƒë·ªô m·∫°nh</span>
                        </div>
                    </div>
                    <div class="col">
                        <label for="iterations">‚öôÔ∏è S·ªë l·∫ßn l·∫∑p PBKDF2:</label>
                        <input id="iterations" type="number" value="200000" min="10000" step="10000" />
                        <small>Gi√° tr·ªã cao h∆°n = b·∫£o m·∫≠t h∆°n nh∆∞ng ch·∫≠m h∆°n (khuy·∫øn ngh·ªã: 200,000)</small>
                    </div>
                </div>

                <div class="actions">
                    <button id="encryptBtn" class="primary">üîí M√£ H√≥a</button>
                    <button id="decryptBtn" class="secondary">üîì Gi·∫£i M√£ Ng∆∞·ª£c</button>
                    <button id="copyBtn" class="success">üìã Copy K·∫øt Qu·∫£</button>
                    <button id="downloadBtn" class="info">üíæ T·∫£i Xu·ªëng</button>
                    <button id="clearBtn" class="danger">üóëÔ∏è X√≥a T·∫•t C·∫£</button>
                </div>

                <div class="section">
                    <label for="outputText">üì§ K·∫øt qu·∫£ m√£ h√≥a (Base64):</label>
                    <textarea id="outputText" rows="6" readonly placeholder="K·∫øt qu·∫£ m√£ h√≥a s·∫Ω hi·ªÉn th·ªã t·∫°i ƒë√¢y..."></textarea>
                    <div class="text-info">
                        <span>K√≠ch th∆∞·ªõc: <span id="outputSize">0</span> bytes</span>
                        <span class="separator">‚Ä¢</span>
                        <span>T·ª∑ l·ªá n√©n: <span id="compressionRatio">0%</span></span>
                    </div>
                </div>
            </div>

            <!-- Tab 2: Gi·∫£i m√£ vƒÉn b·∫£n -->
            <div id="decrypt-tab" class="tab-content">
                <div class="section">
                    <label for="decryptInput">üì• D·ªØ li·ªáu m√£ h√≥a (Base64):</label>
                    <textarea id="decryptInput" placeholder="D√°n d·ªØ li·ªáu ƒë√£ m√£ h√≥a v√†o ƒë√¢y..." rows="6"></textarea>
                    <div class="upload-area" id="uploadArea">
                        <div class="upload-icon">üìÅ</div>
                        <p>Ho·∫∑c k√©o th·∫£ file .txt ch·ª©a d·ªØ li·ªáu m√£ h√≥a v√†o ƒë√¢y</p>
                        <input type="file" id="loadFileInput" accept=".txt" style="display: none;">
                        <button type="button" id="loadFileBtn" class="upload-btn">Ch·ªçn File</button>
                    </div>
                </div>

                <div class="row">
                    <div class="col">
                        <label for="decryptPassword">üîë M·∫≠t kh·∫©u gi·∫£i m√£:</label>
                        <div class="password-container">
                            <input id="decryptPassword" type="password" placeholder="Nh·∫≠p m·∫≠t kh·∫©u ƒë√£ d√πng ƒë·ªÉ m√£ h√≥a" />
                            <button type="button" class="password-toggle" id="toggleDecryptPassword">üëÅÔ∏è</button>
                        </div>
                    </div>
                    <div class="col">
                        <label for="decryptIterations">‚öôÔ∏è S·ªë l·∫ßn l·∫∑p PBKDF2:</label>
                        <input id="decryptIterations" type="number" value="200000" min="10000" step="10000" />
                        <small>Ph·∫£i tr√πng v·ªõi gi√° tr·ªã ƒë√£ d√πng khi m√£ h√≥a</small>
                    </div>
                </div>

                <div class="actions">
                    <button id="decryptOnlyBtn" class="primary">üîì Gi·∫£i M√£</button>
                    <button id="copyDecryptBtn" class="success">üìã Copy K·∫øt Qu·∫£</button>
                    <button id="saveDecryptBtn" class="info">üíæ L∆∞u K·∫øt Qu·∫£</button>
                </div>

                <div class="section">
                    <label for="decryptOutput">üìù K·∫øt qu·∫£ gi·∫£i m√£:</label>
                    <textarea id="decryptOutput" rows="6" readonly placeholder="VƒÉn b·∫£n g·ªëc s·∫Ω hi·ªÉn th·ªã t·∫°i ƒë√¢y sau khi gi·∫£i m√£..."></textarea>
                    <div class="decrypt-status" id="decryptStatus" style="display: none;"></div>
                </div>
            </div>

            <!-- Tab 3: M√£ h√≥a file -->
            <div id="file-tab" class="tab-content">
                <div class="section">
                    <label for="fileInput">üìÅ Ch·ªçn file c·∫ßn m√£ h√≥a:</label>
                    <div class="file-drop-area" id="fileDropArea">
                        <div class="file-drop-icon">üìÑ</div>
                        <p>K√©o th·∫£ file v√†o ƒë√¢y ho·∫∑c click ƒë·ªÉ ch·ªçn</p>
                        <input type="file" id="fileInput" accept="*/*" />
                        <button type="button" class="upload-btn">Ch·ªçn File</button>
                    </div>

                    <!-- Th√¥ng tin file ƒë√£ ch·ªçn -->
                    <div class="file-info" id="fileInfo" style="display: none;">
                        <h4>üìã Th√¥ng tin file:</h4>
                        <div class="info-grid">
                            <div class="info-item">
                                <span class="info-label">T√™n file:</span>
                                <span class="info-value" id="fileName">-</span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">K√≠ch th∆∞·ªõc:</span>
                                <span class="info-value" id="fileSize">-</span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">Lo·∫°i file:</span>
                                <span class="info-value" id="fileType">-</span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">S·ª≠a ƒë·ªïi l·∫ßn cu·ªëi:</span>
                                <span class="info-value" id="fileModified">-</span>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="row">
                    <div class="col">
                        <label for="filePassword">üîë M·∫≠t kh·∫©u m√£ h√≥a file:</label>
                        <div class="password-container">
                            <input id="filePassword" type="password" placeholder="M·∫≠t kh·∫©u b·∫£o v·ªá file" />
                            <button type="button" class="password-toggle" id="toggleFilePassword">üëÅÔ∏è</button>
                        </div>
                    </div>
                    <div class="col">
                        <label for="fileIterations">‚öôÔ∏è S·ªë l·∫ßn l·∫∑p PBKDF2:</label>
                        <input id="fileIterations" type="number" value="200000" min="10000" step="10000" />
                        <small>File l·ªõn n√™n d√πng gi√° tr·ªã th·∫•p h∆°n (100,000 - 200,000)</small>
                    </div>
                </div>

                <div class="actions">
                    <button id="encryptFileBtn" class="primary">üîí M√£ H√≥a File</button>
                    <button id="decryptFileBtn" class="secondary">üîì Gi·∫£i M√£ File</button>
                    <button id="clearFileBtn" class="danger">üóëÔ∏è X√≥a</button>
                </div>

                <!-- Thanh ti·∫øn tr√¨nh -->
                <div class="progress-container" id="progressContainer" style="display: none;">
                    <div class="progress-info">
                        <span id="progressLabel">ƒêang x·ª≠ l√Ω...</span>
                        <span id="progressPercent">0%</span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="progressFill"></div>
                    </div>
                    <div class="progress-details">
                        <span id="progressSpeed">-</span>
                        <span class="separator">‚Ä¢</span>
                        <span id="progressETA">-</span>
                    </div>
                </div>
            </div>

            <!-- Tab 4: Th√¥ng tin -->
            <div id="info-tab" class="tab-content">
                <div class="info-section">
                    <h3>üîê Thu·∫≠t To√°n M√£ H√≥a</h3>
                    <div class="info-grid">
                        <div class="info-item">
                            <span class="info-label">Thu·∫≠t to√°n ch√≠nh:</span>
                            <span class="info-value">AES-256-GCM</span>
                        </div>
                        <div class="info-item">
                            <span class="info-label">Ch·∫ø ƒë·ªô m√£ h√≥a:</span>
                            <span class="info-value">Galois/Counter Mode</span>
                        </div>
                        <div class="info-item">
                            <span class="info-label">ƒê·ªô d√†i kh√≥a:</span>
                            <span class="info-value">256 bit (32 bytes)</span>
                        </div>
                        <div class="info-item">
                            <span class="info-label">Key Derivation:</span>
                            <span class="info-value">PBKDF2-SHA256</span>
                        </div>
                        <div class="info-item">
                            <span class="info-label">Salt Size:</span>
                            <span class="info-value">128 bit (16 bytes)</span>
                        </div>
                        <div class="info-item">
                            <span class="info-label">IV Size:</span>
                            <span class="info-value">96 bit (12 bytes)</span>
                        </div>
                        <div class="info-item">
                            <span class="info-label">Authentication Tag:</span>
                            <span class="info-value">128 bit (16 bytes)</span>
                        </div>
                        <div class="info-item">
                            <span class="info-label">Iterations m·∫∑c ƒë·ªãnh:</span>
                            <span class="info-value">200,000 l·∫ßn</span>
                        </div>
                    </div>
                </div>

                <div class="info-section">
                    <h3>üõ°Ô∏è T√≠nh NƒÉng B·∫£o M·∫≠t</h3>
                    <ul class="feature-list">
                        <li><strong>M√£ h√≥a ƒë·ªëi x·ª©ng m·∫°nh:</strong> AES-256 ƒë∆∞·ª£c NSA c√¥ng nh·∫≠n cho d·ªØ li·ªáu t·ªëi m·∫≠t</li>
                        <li><strong>X√°c th·ª±c t√≠nh to√†n v·∫πn:</strong> GCM mode t·ª± ƒë·ªông ph√°t hi·ªán d·ªØ li·ªáu b·ªã thay ƒë·ªïi</li>
                        <li><strong>Ch·ªëng brute force:</strong> PBKDF2 v·ªõi 200,000 iterations l√†m ch·∫≠m t·∫•n c√¥ng</li>
                        <li><strong>Ch·ªëng rainbow table:</strong> Salt ng·∫´u nhi√™n 128-bit cho m·ªói l·∫ßn m√£ h√≥a</li>
                        <li><strong>Ng·∫´u nhi√™n h√≥a:</strong> IV ng·∫´u nhi√™n ƒë·∫£m b·∫£o c√πng d·ªØ li·ªáu cho k·∫øt qu·∫£ kh√°c nhau</li>
                        <li><strong>Kh√¥ng l∆∞u tr·ªØ kh√≥a:</strong> Kh√≥a ƒë∆∞·ª£c t·∫°o m·ªõi t·ª´ m·∫≠t kh·∫©u m·ªói l·∫ßn s·ª≠ d·ª•ng</li>
                    </ul>
                </div>

                <div class="info-section">
                    <h3>‚ö†Ô∏è L∆∞u √ù Quan Tr·ªçng</h3>
                    <div class="warning-box">
                        <ul>
                            <li><strong>Ch·ªâ d√πng cho h·ªçc t·∫≠p:</strong> ƒê√¢y l√† demo gi√°o d·ª•c, kh√¥ng d√πng cho d·ªØ li·ªáu th·ª±c t·∫ø quan tr·ªçng</li>
                            <li><strong>M·∫≠t kh·∫©u m·∫°nh:</strong> S·ª≠ d·ª•ng m·∫≠t kh·∫©u d√†i, ph·ª©c t·∫°p v·ªõi ch·ªØ hoa, th∆∞·ªùng, s·ªë v√† k√Ω t·ª± ƒë·∫∑c bi·ªát</li>
                            <li><strong>Sao l∆∞u an to√†n:</strong> Lu√¥n sao l∆∞u d·ªØ li·ªáu g·ªëc tr∆∞·ªõc khi m√£ h√≥a</li>
                            <li><strong>Nh·ªõ m·∫≠t kh·∫©u:</strong> Kh√¥ng c√≥ c√°ch n√†o kh√¥i ph·ª•c m·∫≠t kh·∫©u n·∫øu qu√™n</li>
                            <li><strong>Ki·ªÉm tra k·∫øt qu·∫£:</strong> Lu√¥n th·ª≠ gi·∫£i m√£ ngay sau khi m√£ h√≥a</li>
                            <li><strong>M√¥i tr∆∞·ªùng an to√†n:</strong> Kh√¥ng s·ª≠ d·ª•ng tr√™n m√°y t√≠nh c√¥ng c·ªông ho·∫∑c kh√¥ng tin c·∫≠y</li>
                        </ul>
                    </div>
                </div>

                <div class="info-section">
                    <h3>üéì Ki·∫øn Th·ª©c M·ªü R·ªông</h3>
                    <div class="knowledge-grid">
                        <div class="knowledge-item">
                            <h4>AES (Advanced Encryption Standard)</h4>
                            <p>Thu·∫≠t to√°n m√£ h√≥a ƒë·ªëi x·ª©ng ƒë∆∞·ª£c NIST chu·∫©n h√≥a nƒÉm 2001, thay th·∫ø DES. AES-256 s·ª≠ d·ª•ng kh√≥a 256-bit v√† ƒë∆∞·ª£c coi l√† an to√†n tr∆∞·ªõc c·∫£ m√°y t√≠nh l∆∞·ª£ng t·ª≠.</p>
                        </div>
                        <div class="knowledge-item">
                            <h4>GCM (Galois/Counter Mode)</h4>
                            <p>Ch·∫ø ƒë·ªô ho·∫°t ƒë·ªông c·ªßa AES cung c·∫•p c·∫£ m√£ h√≥a v√† x√°c th·ª±c. GCM t·∫°o ra authentication tag ƒë·ªÉ ƒë·∫£m b·∫£o d·ªØ li·ªáu kh√¥ng b·ªã thay ƒë·ªïi.</p>
                        </div>
                        <div class="knowledge-item">
                            <h4>PBKDF2 (Password-Based Key Derivation Function 2)</h4>
                            <p>H√†m sinh kh√≥a t·ª´ m·∫≠t kh·∫©u s·ª≠ d·ª•ng nhi·ªÅu v√≤ng l·∫∑p hash ƒë·ªÉ ch·ªëng l·∫°i t·∫•n c√¥ng brute force. C√†ng nhi·ªÅu iterations c√†ng an to√†n.</p>
                        </div>
                        <div class="knowledge-item">
                            <h4>Salt v√† IV</h4>
                            <p>Salt v√† IV (Initialization Vector) l√† c√°c gi√° tr·ªã ng·∫´u nhi√™n ƒë·∫£m b·∫£o c√πng m·ªôt m·∫≠t kh·∫©u/d·ªØ li·ªáu s·∫Ω t·∫°o ra k·∫øt qu·∫£ m√£ h√≥a kh√°c nhau m·ªói l·∫ßn.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Th√¥ng b√°o tr·∫°ng th√°i -->
        <div class="notification" id="notification" style="display: none;">
            <span class="notification-text"></span>
            <button class="notification-close">&times;</button>
        </div>
    </main>

    <script>
        // ===== C√ÅC H√ÄM HELPER =====

        /**
         * Chuy·ªÉn ƒë·ªïi ArrayBuffer th√†nh chu·ªói Base64
         * @param {ArrayBuffer} buffer - Buffer c·∫ßn chuy·ªÉn ƒë·ªïi
         * @returns {string} Chu·ªói Base64
         */
        function abToBase64(buffer) {
            const bytes = new Uint8Array(buffer);
            let binary = '';
            const chunkSize = 0x8000; // X·ª≠ l√Ω t·ª´ng chunk 32KB ƒë·ªÉ tr√°nh stack overflow
            for (let i = 0; i < bytes.length; i += chunkSize) {
                binary += String.fromCharCode.apply(null, bytes.subarray(i, i + chunkSize));
            }
            return btoa(binary);
        }

        /**
         * Chuy·ªÉn ƒë·ªïi chu·ªói Base64 th√†nh ArrayBuffer
         * @param {string} base64 - Chu·ªói Base64
         * @returns {ArrayBuffer} Buffer d·ªØ li·ªáu
         */
        function base64ToAb(base64) {
            const binary = atob(base64);
            const len = binary.length;
            const bytes = new Uint8Array(len);
            for (let i = 0; i < len; i++) {
                bytes[i] = binary.charCodeAt(i);
            }
            return bytes.buffer;
        }

        /**
         * Ki·ªÉm tra ƒë·ªô m·∫°nh c·ªßa m·∫≠t kh·∫©u
         * @param {string} password - M·∫≠t kh·∫©u c·∫ßn ki·ªÉm tra
         * @returns {Object} Th√¥ng tin v·ªÅ ƒë·ªô m·∫°nh m·∫≠t kh·∫©u
         */
        function checkPasswordStrength(password) {
            let score = 0;
            const feedback = [];

            // Ki·ªÉm tra ƒë·ªô d√†i
            if (password.length >= 8) score += 1;
            else feedback.push('√çt nh·∫•t 8 k√Ω t·ª±');

            // Ki·ªÉm tra ch·ªØ th∆∞·ªùng
            if (/[a-z]/.test(password)) score += 1;
            else feedback.push('Ch·ªØ th∆∞·ªùng (a-z)');

            // Ki·ªÉm tra ch·ªØ hoa
            if (/[A-Z]/.test(password)) score += 1;
            else feedback.push('Ch·ªØ hoa (A-Z)');

            // Ki·ªÉm tra s·ªë
            if (/[0-9]/.test(password)) score += 1;
            else feedback.push('S·ªë (0-9)');

            // Ki·ªÉm tra k√Ω t·ª± ƒë·∫∑c bi·ªát
            if (/[^A-Za-z0-9]/.test(password)) score += 1;
            else feedback.push('K√Ω t·ª± ƒë·∫∑c bi·ªát (!@#$...)');

            const levels = ['R·∫•t y·∫øu', 'Y·∫øu', 'Trung b√¨nh', 'M·∫°nh', 'R·∫•t m·∫°nh'];
            const colors = ['#ff4444', '#ff8800', '#ffaa00', '#88aa00', '#44aa44'];

            return {
                score,
                level: levels[score] || 'Kh√¥ng x√°c ƒë·ªãnh',
                color: colors[score] || '#666666',
                feedback: feedback,
                percentage: (score / 5) * 100
            };
        }

        /**
         * ƒê·ªãnh d·∫°ng k√≠ch th∆∞·ªõc file
         * @param {number} bytes - S·ªë bytes
         * @returns {string} Chu·ªói ƒë·ªãnh d·∫°ng (VD: "1.5 MB")
         */
        function formatFileSize(bytes) {
            if (bytes === 0) return '0 Bytes';
            const k = 1024;
            const sizes = ['Bytes', 'KB', 'MB', 'GB', 'TB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
        }

        /**
         * ƒê·ªãnh d·∫°ng th·ªùi gian
         * @param {Date} date - ƒê·ªëi t∆∞·ª£ng Date
         * @returns {string} Chu·ªói th·ªùi gian ƒë·ªãnh d·∫°ng
         */
        function formatDateTime(date) {
            return date.toLocaleString('vi-VN', {
                year: 'numeric',
                month: '2-digit',
                day: '2-digit',
                hour: '2-digit',
                minute: '2-digit',
                second: '2-digit'
            });
        }

        // ===== C√ÅC H√ÄM M√É H√ìA =====

        /**
         * T·∫°o kh√≥a AES-GCM t·ª´ m·∫≠t kh·∫©u s·ª≠ d·ª•ng PBKDF2
         * @param {string} password - M·∫≠t kh·∫©u ƒë·∫ßu v√†o
         * @param {ArrayBuffer} salt - Salt ng·∫´u nhi√™n
         * @param {number} iterations - S·ªë l·∫ßn l·∫∑p PBKDF2
         * @param {number} keyLength - ƒê·ªô d√†i kh√≥a (bit)
         * @returns {Promise<CryptoKey>} Kh√≥a AES-GCM
         */
        async function deriveKey(password, salt, iterations = 200000, keyLength = 256) {
            const enc = new TextEncoder();

            // Import m·∫≠t kh·∫©u th√†nh raw key
            const passKey = await crypto.subtle.importKey(
                'raw',
                enc.encode(password),
                'PBKDF2',
                false, ['deriveKey']
            );

            // Derive kh√≥a AES t·ª´ m·∫≠t kh·∫©u
            return crypto.subtle.deriveKey({
                    name: 'PBKDF2',
                    salt: salt,
                    iterations: iterations,
                    hash: 'SHA-256'
                },
                passKey, {
                    name: 'AES-GCM',
                    length: keyLength
                },
                false, ['encrypt', 'decrypt']
            );
        }

        /**
         * M√£ h√≥a vƒÉn b·∫£n th√†nh Base64
         * @param {string} plaintext - VƒÉn b·∫£n g·ªëc
         * @param {string} password - M·∫≠t kh·∫©u
         * @param {number} iterations - S·ªë l·∫ßn l·∫∑p PBKDF2
         * @returns {Promise<string>} Chu·ªói Base64 ch·ª©a salt|iv|ciphertext
         */
        async function encryptText(plaintext, password, iterations) {
            const enc = new TextEncoder();

            // T·∫°o salt v√† IV ng·∫´u nhi√™n
            const salt = crypto.getRandomValues(new Uint8Array(16)); // 128-bit salt
            const iv = crypto.getRandomValues(new Uint8Array(12)); // 96-bit IV cho GCM

            // T·∫°o kh√≥a t·ª´ m·∫≠t kh·∫©u
            const key = await deriveKey(password, salt.buffer, iterations);

            // M√£ h√≥a d·ªØ li·ªáu
            const ciphertext = await crypto.subtle.encrypt({
                    name: 'AES-GCM',
                    iv: iv
                },
                key,
                enc.encode(plaintext)
            );

            // ƒê√≥ng g√≥i: salt + iv + ciphertext
            const packageSize = salt.byteLength + iv.byteLength + ciphertext.byteLength;
            const packagedData = new Uint8Array(packageSize);

            packagedData.set(salt, 0);
            packagedData.set(iv, salt.byteLength);
            packagedData.set(new Uint8Array(ciphertext), salt.byteLength + iv.byteLength);

            return abToBase64(packagedData.buffer);
        }

        /**
         * Gi·∫£i m√£ d·ªØ li·ªáu Base64 th√†nh vƒÉn b·∫£n
         * @param {string} b64package - D·ªØ li·ªáu Base64 ch·ª©a salt|iv|ciphertext
         * @param {string} password - M·∫≠t kh·∫©u
         * @param {number} iterations - S·ªë l·∫ßn l·∫∑p PBKDF2
         * @returns {Promise<string>} VƒÉn b·∫£n g·ªëc
         */
        async function decryptText(b64package, password, iterations) {
            // Parse d·ªØ li·ªáu t·ª´ Base64
            const packageAb = base64ToAb(b64package);
            const packageBytes = new Uint8Array(packageAb);

            // Ki·ªÉm tra ƒë·ªô d√†i t·ªëi thi·ªÉu (16 + 12 + 16 = 44 bytes)
            if (packageBytes.length < 44) {
                throw new Error('D·ªØ li·ªáu kh√¥ng h·ª£p l·ªá: qu√° ng·∫Øn (t·ªëi thi·ªÉu 44 bytes)');
            }

            // T√°ch c√°c th√†nh ph·∫ßn
            const salt = packageBytes.slice(0, 16); // 16 bytes ƒë·∫ßu
            const iv = packageBytes.slice(16, 28); // 12 bytes ti·∫øp theo
            const ciphertext = packageBytes.slice(28); // Ph·∫ßn c√≤n l·∫°i

            // T·∫°o l·∫°i kh√≥a t·ª´ m·∫≠t kh·∫©u v√† salt
            const key = await deriveKey(password, salt.buffer, iterations);

            // Gi·∫£i m√£
            const decrypted = await crypto.subtle.decrypt({
                    name: 'AES-GCM',
                    iv: iv
                },
                key,
                ciphertext.buffer
            );

            // Chuy·ªÉn ƒë·ªïi v·ªÅ vƒÉn b·∫£n
            const dec = new TextDecoder();
            return dec.decode(decrypted);
        }

        /**
         * M√£ h√≥a file
         * @param {ArrayBuffer} fileBuffer - D·ªØ li·ªáu file
         * @param {string} password - M·∫≠t kh·∫©u
         * @param {number} iterations - S·ªë l·∫ßn l·∫∑p PBKDF2
         * @param {Function} onProgress - Callback b√°o ti·∫øn tr√¨nh
         * @returns {Promise<Uint8Array>} D·ªØ li·ªáu file ƒë√£ m√£ h√≥a
         */
        async function encryptFile(fileBuffer, password, iterations, onProgress) {
            const salt = crypto.getRandomValues(new Uint8Array(16));
            const iv = crypto.getRandomValues(new Uint8Array(12));

            if (onProgress) onProgress(25, 'T·∫°o kh√≥a m√£ h√≥a...');

            const key = await deriveKey(password, salt.buffer, iterations);

            if (onProgress) onProgress(50, 'ƒêang m√£ h√≥a file...');

            const ciphertext = await crypto.subtle.encrypt({
                    name: 'AES-GCM',
                    iv: iv
                },
                key,
                fileBuffer
            );

            if (onProgress) onProgress(90, 'Ho√†n t·∫•t ƒë√≥ng g√≥i...');

            // ƒê√≥ng g√≥i k·∫øt qu·∫£
            const packageSize = salt.byteLength + iv.byteLength + ciphertext.byteLength;
            const packagedData = new Uint8Array(packageSize);

            packagedData.set(salt, 0);
            packagedData.set(iv, salt.byteLength);
            packagedData.set(new Uint8Array(ciphertext), salt.byteLength + iv.byteLength);

            if (onProgress) onProgress(100, 'Ho√†n th√†nh!');

            return packagedData;
        }

        // ===== QU·∫¢N L√ù GIAO DI·ªÜN =====

        /**
         * Hi·ªÉn th·ªã th√¥ng b√°o
         * @param {string} message - N·ªôi dung th√¥ng b√°o
         * @param {string} type - Lo·∫°i th√¥ng b√°o (success, error, warning, info)
         * @param {number} duration - Th·ªùi gian hi·ªÉn th·ªã (ms)
         */
        function showNotification(message, type = 'info', duration = 5000) {
            const notification = document.getElementById('notification');
            const notificationText = notification.querySelector('.notification-text');

            notificationText.textContent = message;
            notification.className = `notification ${type}`;
            notification.style.display = 'flex';

            // T·ª± ƒë·ªông ·∫©n sau duration
            setTimeout(() => {
                notification.style.display = 'none';
            }, duration);
        }

        /**
         * C·∫≠p nh·∫≠t thanh ti·∫øn tr√¨nh
         * @param {number} percent - Ph·∫ßn trƒÉm ho√†n th√†nh
         * @param {string} label - Nh√£n m√¥ t·∫£
         * @param {string} speed - T·ªëc ƒë·ªô x·ª≠ l√Ω
         * @param {string} eta - Th·ªùi gian c√≤n l·∫°i
         */
        function updateProgress(percent, label = '', speed = '', eta = '') {
            const progressContainer = document.getElementById('progressContainer');
            const progressFill = document.getElementById('progressFill');
            const progressLabel = document.getElementById('progressLabel');
            const progressPercent = document.getElementById('progressPercent');
            const progressSpeed = document.getElementById('progressSpeed');
            const progressETA = document.getElementById('progressETA');

            progressFill.style.width = percent + '%';
            progressPercent.textContent = Math.round(percent) + '%';

            if (label) progressLabel.textContent = label;
            if (speed) progressSpeed.textContent = speed;
            if (eta) progressETA.textContent = eta;

            if (percent > 0) {
                progressContainer.style.display = 'block';
            }

            if (percent >= 100) {
                setTimeout(() => {
                    progressContainer.style.display = 'none';
                }, 1000);
            }
        }

        // ===== KH·ªûI T·∫†O GIAO DI·ªÜN =====

        // L·∫•y t·∫•t c·∫£ c√°c ph·∫ßn t·ª≠ DOM
        const elements = {
            // Tab controls
            tabBtns: document.querySelectorAll('.tab-btn'),
            tabContents: document.querySelectorAll('.tab-content'),

            // Encrypt tab elements
            inputText: document.getElementById('inputText'),
            password: document.getElementById('password'),
            iterations: document.getElementById('iterations'),
            encryptBtn: document.getElementById('encryptBtn'),
            decryptBtn: document.getElementById('decryptBtn'),
            outputText: document.getElementById('outputText'),
            copyBtn: document.getElementById('copyBtn'),
            downloadBtn: document.getElementById('downloadBtn'),
            clearBtn: document.getElementById('clearBtn'),
            togglePassword: document.getElementById('togglePassword'),
            strengthFill: document.getElementById('strengthFill'),
            strengthText: document.getElementById('strengthText'),
            inputLength: document.getElementById('inputLength'),
            outputSize: document.getElementById('outputSize'),
            compressionRatio: document.getElementById('compressionRatio'),

            // Decrypt tab elements
            decryptInput: document.getElementById('decryptInput'),
            decryptPassword: document.getElementById('decryptPassword'),
            decryptIterations: document.getElementById('decryptIterations'),
            decryptOnlyBtn: document.getElementById('decryptOnlyBtn'),
            decryptOutput: document.getElementById('decryptOutput'),
            copyDecryptBtn: document.getElementById('copyDecryptBtn'),
            saveDecryptBtn: document.getElementById('saveDecryptBtn'),
            toggleDecryptPassword: document.getElementById('toggleDecryptPassword'),
            loadFileInput: document.getElementById('loadFileInput'),
            loadFileBtn: document.getElementById('loadFileBtn'),
            uploadArea: document.getElementById('uploadArea'),
            decryptStatus: document.getElementById('decryptStatus'),

            // File tab elements
            fileInput: document.getElementById('fileInput'),
            fileDropArea: document.getElementById('fileDropArea'),
            fileInfo: document.getElementById('fileInfo'),
            fileName: document.getElementById('fileName'),
            fileSize: document.getElementById('fileSize'),
            fileType: document.getElementById('fileType'),
            fileModified: document.getElementById('fileModified'),
            filePassword: document.getElementById('filePassword'),
            fileIterations: document.getElementById('fileIterations'),
            encryptFileBtn: document.getElementById('encryptFileBtn'),
            decryptFileBtn: document.getElementById('decryptFileBtn'),
            clearFileBtn: document.getElementById('clearFileBtn'),
            toggleFilePassword: document.getElementById('toggleFilePassword'),

            // Notification
            notification: document.getElementById('notification'),
            notificationClose: document.querySelector('.notification-close')
        };

        // ===== X·ª¨ L√ù S·ª∞ KI·ªÜN =====

        // Chuy·ªÉn ƒë·ªïi tab
        elements.tabBtns.forEach(btn => {
            btn.addEventListener('click', () => {
                const tabId = btn.dataset.tab;

                // X√≥a class active t·ª´ t·∫•t c·∫£ tab
                elements.tabBtns.forEach(b => b.classList.remove('active'));
                elements.tabContents.forEach(c => c.classList.remove('active'));

                // Th√™m class active cho tab ƒë∆∞·ª£c ch·ªçn
                btn.classList.add('active');
                document.getElementById(tabId + '-tab').classList.add('active');
            });
        });

        // Hi·ªán/·∫©n m·∫≠t kh·∫©u
        function setupPasswordToggle(toggleBtn, passwordInput) {
            toggleBtn.addEventListener('click', () => {
                const type = passwordInput.type === 'password' ? 'text' : 'password';
                passwordInput.type = type;
                toggleBtn.textContent = type === 'password' ? 'üëÅÔ∏è' : 'üôà';
            });
        }

        setupPasswordToggle(elements.togglePassword, elements.password);
        setupPasswordToggle(elements.toggleDecryptPassword, elements.decryptPassword);
        setupPasswordToggle(elements.toggleFilePassword, elements.filePassword);

        // Ki·ªÉm tra ƒë·ªô m·∫°nh m·∫≠t kh·∫©u
        elements.password.addEventListener('input', (e) => {
            const password = e.target.value;
            elements.inputLength.textContent = elements.inputText.value.length;

            if (!password) {
                elements.strengthFill.style.width = '0%';
                elements.strengthText.textContent = 'Nh·∫≠p m·∫≠t kh·∫©u ƒë·ªÉ ki·ªÉm tra ƒë·ªô m·∫°nh';
                return;
            }

            const result = checkPasswordStrength(password);
            elements.strengthFill.style.width = result.percentage + '%';
            elements.strengthFill.style.backgroundColor = result.color;

            let text = `${result.level} (${Math.round(result.percentage)}%)`;
            if (result.feedback.length > 0) {
                text += ` - Thi·∫øu: ${result.feedback.join(', ')}`;
            }
            elements.strengthText.textContent = text;
        });

        // C·∫≠p nh·∫≠t ƒë·ªô d√†i vƒÉn b·∫£n
        elements.inputText.addEventListener('input', () => {
            elements.inputLength.textContent = elements.inputText.value.length;
        });

        // C·∫≠p nh·∫≠t k√≠ch th∆∞·ªõc output
        elements.outputText.addEventListener('input', () => {
            const outputLength = elements.outputText.value.length;
            const inputLength = elements.inputText.value.length;

            elements.outputSize.textContent = outputLength;

            if (inputLength > 0) {
                const ratio = ((outputLength - inputLength) / inputLength * 100).toFixed(1);
                elements.compressionRatio.textContent = ratio + '%';
            } else {
                elements.compressionRatio.textContent = '0%';
            }
        });

        // X·ª≠ l√Ω file input
        elements.fileInput.addEventListener('change', (e) => {
            const file = e.target.files[0];
            if (file) {
                displayFileInfo(file);
            } else {
                elements.fileInfo.style.display = 'none';
            }
        });

        // X·ª≠ l√Ω drag & drop cho file
        elements.fileDropArea.addEventListener('dragover', (e) => {
            e.preventDefault();
            elements.fileDropArea.classList.add('dragover');
        });

        elements.fileDropArea.addEventListener('dragleave', (e) => {
            e.preventDefault();
            elements.fileDropArea.classList.remove('dragover');
        });

        elements.fileDropArea.addEventListener('drop', (e) => {
            e.preventDefault();
            elements.fileDropArea.classList.remove('dragover');

            const files = e.dataTransfer.files;
            if (files.length > 0) {
                elements.fileInput.files = files;
                displayFileInfo(files[0]);
            }
        });

        // X·ª≠ l√Ω drag & drop cho decrypt
        elements.uploadArea.addEventListener('dragover', (e) => {
            e.preventDefault();
            elements.uploadArea.classList.add('dragover');
        });

        elements.uploadArea.addEventListener('dragleave', (e) => {
            e.preventDefault();
            elements.uploadArea.classList.remove('dragover');
        });

        elements.uploadArea.addEventListener('drop', (e) => {
            e.preventDefault();
            elements.uploadArea.classList.remove('dragover');

            const files = e.dataTransfer.files;
            if (files.length > 0 && files[0].name.endsWith('.txt')) {
                loadTextFile(files[0]);
            }
        });

        // Load file button
        elements.loadFileBtn.addEventListener('click', () => {
            elements.loadFileInput.click();
        });

        elements.loadFileInput.addEventListener('change', (e) => {
            const file = e.target.files[0];
            if (file) {
                loadTextFile(file);
            }
        });

        /**
         * Hi·ªÉn th·ªã th√¥ng tin file
         * @param {File} file - ƒê·ªëi t∆∞·ª£ng file
         */
        function displayFileInfo(file) {
            elements.fileName.textContent = file.name;
            elements.fileSize.textContent = formatFileSize(file.size);
            elements.fileType.textContent = file.type || 'Kh√¥ng x√°c ƒë·ªãnh';
            elements.fileModified.textContent = formatDateTime(new Date(file.lastModified));
            elements.fileInfo.style.display = 'block';
        }

        /**
         * T·∫£i n·ªôi dung file text
         * @param {File} file - File text
         */
        function loadTextFile(file) {
            const reader = new FileReader();
            reader.onload = (e) => {
                elements.decryptInput.value = e.target.result;
                showNotification(`ƒê√£ t·∫£i file: ${file.name}`, 'success');
            };
            reader.onerror = () => {
                showNotification('L·ªói khi ƒë·ªçc file', 'error');
            };
            reader.readAsText(file);
        }

        // ===== X·ª¨ L√ù C√ÅC CH·ª®C NƒÇNG CH√çNH =====

        // M√£ h√≥a vƒÉn b·∫£n
        elements.encryptBtn.addEventListener('click', async() => {
            const text = elements.inputText.value.trim();
            const password = elements.password.value;
            const iterations = parseInt(elements.iterations.value) || 200000;

            // Validation
            if (!text) {
                showNotification('Vui l√≤ng nh·∫≠p vƒÉn b·∫£n c·∫ßn m√£ h√≥a', 'warning');
                return;
            }
            if (!password) {
                showNotification('Vui l√≤ng nh·∫≠p m·∫≠t kh·∫©u b·∫£o m·∫≠t', 'warning');
                return;
            }
            if (password.length < 6) {
                showNotification('M·∫≠t kh·∫©u ph·∫£i c√≥ √≠t nh·∫•t 6 k√Ω t·ª±', 'warning');
                return;
            }

            try {
                elements.encryptBtn.disabled = true;
                elements.encryptBtn.textContent = 'üîÑ ƒêang m√£ h√≥a...';

                const encrypted = await encryptText(text, password, iterations);
                elements.outputText.value = encrypted;

                showNotification('‚úÖ M√£ h√≥a th√†nh c√¥ng!', 'success');
            } catch (error) {
                console.error('Encryption error:', error);
                showNotification('‚ùå L·ªói m√£ h√≥a: ' + error.message, 'error');
            } finally {
                elements.encryptBtn.disabled = false;
                elements.encryptBtn.textContent = 'üîí M√£ H√≥a';
            }
        });

        // Gi·∫£i m√£ vƒÉn b·∫£n (tab encrypt)
        elements.decryptBtn.addEventListener('click', async() => {
            const encryptedData = elements.outputText.value.trim();
            const password = elements.password.value;
            const iterations = parseInt(elements.iterations.value) || 200000;

            if (!encryptedData) {
                showNotification('Kh√¥ng c√≥ d·ªØ li·ªáu m√£ h√≥a ƒë·ªÉ gi·∫£i m√£', 'warning');
                return;
            }
            if (!password) {
                showNotification('Vui l√≤ng nh·∫≠p m·∫≠t kh·∫©u', 'warning');
                return;
            }

            try {
                elements.decryptBtn.disabled = true;
                elements.decryptBtn.textContent = 'üîÑ ƒêang gi·∫£i m√£...';

                const decrypted = await decryptText(encryptedData, password, iterations);
                elements.inputText.value = decrypted;

                showNotification('‚úÖ Gi·∫£i m√£ th√†nh c√¥ng!', 'success');
            } catch (error) {
                console.error('Decryption error:', error);
                showNotification('‚ùå Gi·∫£i m√£ th·∫•t b·∫°i: Sai m·∫≠t kh·∫©u ho·∫∑c d·ªØ li·ªáu b·ªã l·ªói', 'error');
            } finally {
                elements.decryptBtn.disabled = false;
                elements.decryptBtn.textContent = 'üîì Gi·∫£i M√£ Ng∆∞·ª£c';
            }
        });

        // Gi·∫£i m√£ vƒÉn b·∫£n (tab decrypt)
        elements.decryptOnlyBtn.addEventListener('click', async() => {
            const encryptedData = elements.decryptInput.value.trim();
            const password = elements.decryptPassword.value;
            const iterations = parseInt(elements.decryptIterations.value) || 200000;

            if (!encryptedData) {
                showNotification('Vui l√≤ng nh·∫≠p d·ªØ li·ªáu m√£ h√≥a', 'warning');
                return;
            }
            if (!password) {
                showNotification('Vui l√≤ng nh·∫≠p m·∫≠t kh·∫©u', 'warning');
                return;
            }

            try {
                elements.decryptOnlyBtn.disabled = true;
                elements.decryptOnlyBtn.textContent = 'üîÑ ƒêang gi·∫£i m√£...';

                const decrypted = await decryptText(encryptedData, password, iterations);
                elements.decryptOutput.value = decrypted;

                elements.decryptStatus.innerHTML = '<span class="success">‚úÖ Gi·∫£i m√£ th√†nh c√¥ng!</span>';
                elements.decryptStatus.style.display = 'block';

                showNotification('‚úÖ Gi·∫£i m√£ th√†nh c√¥ng!', 'success');
            } catch (error) {
                console.error('Decryption error:', error);
                elements.decryptStatus.innerHTML = '<span class="error">‚ùå Gi·∫£i m√£ th·∫•t b·∫°i: Sai m·∫≠t kh·∫©u ho·∫∑c d·ªØ li·ªáu b·ªã l·ªói</span>';
                elements.decryptStatus.style.display = 'block';
                showNotification('‚ùå Gi·∫£i m√£ th·∫•t b·∫°i: Sai m·∫≠t kh·∫©u ho·∫∑c d·ªØ li·ªáu b·ªã l·ªói', 'error');
            } finally {
                elements.decryptOnlyBtn.disabled = false;
                elements.decryptOnlyBtn.textContent = 'üîì Gi·∫£i M√£';
            }
        });

        // Copy k·∫øt qu·∫£
        elements.copyBtn.addEventListener('click', () => {
            const text = elements.outputText.value;
            if (!text) {
                showNotification('Kh√¥ng c√≥ d·ªØ li·ªáu ƒë·ªÉ copy', 'warning');
                return;
            }

            navigator.clipboard.writeText(text).then(() => {
                showNotification('üìã ƒê√£ copy v√†o clipboard!', 'success');
            }).catch(() => {
                showNotification('‚ùå Kh√¥ng th·ªÉ copy v√†o clipboard', 'error');
            });
        });

        elements.copyDecryptBtn.addEventListener('click', () => {
            const text = elements.decryptOutput.value;
            if (!text) {
                showNotification('Kh√¥ng c√≥ d·ªØ li·ªáu ƒë·ªÉ copy', 'warning');
                return;
            }

            navigator.clipboard.writeText(text).then(() => {
                showNotification('üìã ƒê√£ copy v√†o clipboard!', 'success');
            }).catch(() => {
                showNotification('‚ùå Kh√¥ng th·ªÉ copy v√†o clipboard', 'error');
            });
        });

        // Download file
        elements.downloadBtn.addEventListener('click', () => {
            const data = elements.outputText.value;
            if (!data) {
                showNotification('Kh√¥ng c√≥ d·ªØ li·ªáu ƒë·ªÉ t·∫£i xu·ªëng', 'warning');
                return;
            }

            const blob = new Blob([data], {
                type: 'text/plain;charset=utf-8'
            });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'encrypted_data.txt';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);

            showNotification('üíæ ƒê√£ t·∫£i xu·ªëng file!', 'success');
        });

        elements.saveDecryptBtn.addEventListener('click', () => {
            const data = elements.decryptOutput.value;
            if (!data) {
                showNotification('Kh√¥ng c√≥ d·ªØ li·ªáu ƒë·ªÉ l∆∞u', 'warning');
                return;
            }

            const blob = new Blob([data], {
                type: 'text/plain;charset=utf-8'
            });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'decrypted_data.txt';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);

            showNotification('üíæ ƒê√£ l∆∞u file!', 'success');
        });

        // M√£ h√≥a file
        elements.encryptFileBtn.addEventListener('click', async() => {
            const file = elements.fileInput.files[0];
            const password = elements.filePassword.value;
            const iterations = parseInt(elements.fileIterations.value) || 200000;

            if (!file) {
                showNotification('Vui l√≤ng ch·ªçn file c·∫ßn m√£ h√≥a', 'warning');
                return;
            }
            if (!password) {
                showNotification('Vui l√≤ng nh·∫≠p m·∫≠t kh·∫©u', 'warning');
                return;
            }

            try {
                elements.encryptFileBtn.disabled = true;
                elements.encryptFileBtn.textContent = 'üîÑ ƒêang m√£ h√≥a...';

                updateProgress(0, 'ƒê·ªçc file...');

                const fileBuffer = await file.arrayBuffer();
                const encrypted = await encryptFile(fileBuffer, password, iterations, (percent, label) => {
                    updateProgress(percent, label);
                });

                // T·∫°o file m√£ h√≥a ƒë·ªÉ download
                const blob = new Blob([encrypted], {
                    type: 'application/octet-stream'
                });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = file.name + '.encrypted';
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);

                showNotification(`‚úÖ M√£ h√≥a file th√†nh c√¥ng! ƒê√£ t·∫£i xu·ªëng: ${file.name}.encrypted`, 'success');
            } catch (error) {
                console.error('File encryption error:', error);
                showNotification('‚ùå L·ªói m√£ h√≥a file: ' + error.message, 'error');
            } finally {
                elements.encryptFileBtn.disabled = false;
                elements.encryptFileBtn.textContent = 'üîí M√£ H√≥a File';
                updateProgress(0);
            }
        });

        // X√≥a d·ªØ li·ªáu
        elements.clearBtn.addEventListener('click', () => {
            if (confirm('B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën x√≥a t·∫•t c·∫£ d·ªØ li·ªáu?')) {
                elements.inputText.value = '';
                elements.outputText.value = '';
                elements.password.value = '';
                elements.strengthFill.style.width = '0%';
                elements.strengthText.textContent = 'Nh·∫≠p m·∫≠t kh·∫©u ƒë·ªÉ ki·ªÉm tra ƒë·ªô m·∫°nh';
                elements.inputLength.textContent = '0';
                elements.outputSize.textContent = '0';
                elements.compressionRatio.textContent = '0%';
                showNotification('üóëÔ∏è ƒê√£ x√≥a t·∫•t c·∫£ d·ªØ li·ªáu', 'info');
            }
        });

        elements.clearFileBtn.addEventListener('click', () => {
            if (confirm('B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën x√≥a th√¥ng tin file?')) {
                elements.fileInput.value = '';
                elements.filePassword.value = '';
                elements.fileInfo.style.display = 'none';
                showNotification('üóëÔ∏è ƒê√£ x√≥a th√¥ng tin file', 'info');
            }
        });

        // ƒê√≥ng th√¥ng b√°o
        elements.notificationClose.addEventListener('click', () => {
            elements.notification.style.display = 'none';
        });

        // Kh·ªüi t·∫°o ban ƒë·∫ßu
        document.addEventListener('DOMContentLoaded', () => {
            console.log('üîê ·ª®ng d·ª•ng m√£ h√≥a AES-GCM ƒë√£ s·∫µn s√†ng!');
            showNotification('üîê ·ª®ng d·ª•ng m√£ h√≥a AES-GCM ƒë√£ s·∫µn s√†ng!', 'info', 3000);
        });
    </script>
</body>

</html>